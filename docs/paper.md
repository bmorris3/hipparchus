---
title: 'hipparchus: Cross-correlation functions via the weighted mean'
tags:
  - Python
  - astronomy
  - high resolution spectroscopy
authors:
  - name: Brett M. Morris
    orcid: 0000-0003-2528-3409
    affiliation: 1
affiliations:
 - name: Center for Space and Habitability, University of Bern, Switzerland
   index: 1
date: January 2020
bibliography: paper.bib

aas-doi: 10.3847/xxxxx
aas-journal: Astrophysical Journal
---

# Summary

The presence of starspots on exoplanet host stars potentially hinders the 
interpretation of planet observations. We must know the starspot covering 
fractions of stars in order to interpret the transmission and day-side 
spectra of small exoplanets, because the spectral features generated by 
exoplanet atmospheres are degenerate with the signatures of starspots 
[@Ducrot:2018, @Morris:2018, @Wakeford:2019]. If we 
seek to measure starspot coverages with sufficient precision to mitigate
the effects of starspots on planet characterization, we must develop new 
techniques to measure the spatial extent of starspots. This is difficult to do 
in practice because starspots are dim compared to the rest of the stellar 
photosphere, and take up a small fraction of the stellar surface area 
[@Morris:2019]. 

An analogous contrast-ratio problem occurs when detecting the emission or 
transmission spectra from exoplanet atmospheres, which has been addressed using
the cross-correlation function (CCF) technique applied to high resolution 
spectroscopy [@Snellen:2010, @Brogi:2012]. The CCF is sensitive to both strong 
and weak absorption features that occur at *all* wavelengths throughout the 
spectrum of the planet, constructively co-adding the absorption lines into a 
single average when a template spectrum is matched with the observed spectrum
at the correct Doppler velocity.

We introduce ``hipparchus``, a pure Python, open source package designed for
cross-correlating HARPS with synthetic spectral templates. The 
accompanying submitted paper to AAS Journals applies the package to the problem
of hunting for cool starspots on stellar photospheres, but it could be used
more generally to measure the CCF in a variety of contexts. ``hipparchus`` 
computes the CCF via the weighted mean, with the help of array broadcasting to 
simultaneously compute the CCF efficiently at many velocities. It includes
convenience functions for reading and continuum normalizing HARPS(-N) E2DS 
spectra, along with an object-oriented framework for computing CCFs. 
Contributions to ``hipparchus`` from the community are welcome.

# Acknowledgements

We acknowledge valuable advice from H. Jens Hoeijmakers, and spectral templates
from Daniel Kitzmann.

# References